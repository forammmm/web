<style>
  body.theme-active {
    background: linear-gradient(120deg, #ffe066, #ff6b6b, #6a5acd);
    background-size: 200% 200%;
    animation: surpriseMove 8s ease-in-out infinite;
  }

  @keyframes surpriseMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .confetti {
    position: fixed;
    bottom: 100%;
    width: 8px;
    height: 12px;
    opacity: 0.95;
    border-radius: 2px;
    transform: rotate(10deg);
    animation: confettiFall 4s linear forwards;
  }

  @keyframes confettiFall {
    0% { transform: translateY(0) rotate(0); }
    100% { transform: translateY(120vh) rotate(600deg); opacity: 0; }
  }

  .glow {
    position: fixed;
    border-radius: 50%;
    filter: blur(10px);
    opacity: 0.7;
  }

  .pop-circle {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(circle, #fff5 0%, transparent 70%);
    transform: scale(0);
    animation: popCircle 0.6s ease-out forwards;
    pointer-events: none;
  }

  @keyframes popCircle {
    0% { transform: scale(0); opacity: 1; }
    100% { transform: scale(4); opacity: 0; }
  }
</style>

<div id="theme-animation-container"></div>

<script>
  let surpriseClickListener = null;

  function startTheme() {
    document.body.classList.add('theme-active');
    window.__themeIntervals = window.__themeIntervals || [];

    function createConfetti() {
      const el = document.createElement('div');
      el.className = 'confetti';
      el.style.left = Math.random() * 100 + 'vw';
      el.style.background = ['#ff7b7b','#ffd166','#9ad3bc','#ffd5e5','#fff','#ffe066','#ff6b6b','#6a5acd'][Math.floor(Math.random()*8)];
      el.style.animationDuration = (3 + Math.random()*2) + 's';
      document.body.appendChild(el);
      setTimeout(()=>el.remove(),4500);
    }

    function createGlow() {
      const el = document.createElement('div');
      el.className = 'glow';
      const size = Math.random()*120 + 80;
      el.style.width = el.style.height = size+'px';
      el.style.left = Math.random()*100+'vw';
      el.style.top = Math.random()*100+'vh';
      el.style.background = 'radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,255,255,0.05))';
      document.body.appendChild(el);
      setTimeout(()=>el.remove(),7000);
    }

    window.__themeIntervals.push(setInterval(createConfetti, 250));
    window.__themeIntervals.push(setInterval(createGlow, 1200));

    // ðŸŽ‰ Click burst (works every time while theme is active)
    surpriseClickListener = function(e) {
      const x = e.clientX;
      const y = e.clientY;

      // create pop circle
      const circle = document.createElement('div');
      circle.className = 'pop-circle';
      circle.style.left = (x-50)+'px';
      circle.style.top = (y-50)+'px';
      circle.style.width = circle.style.height = '100px';
      document.body.appendChild(circle);
      setTimeout(()=>circle.remove(),600);

      // extra confetti burst at click
      for(let i=0;i<25;i++){
        const el = document.createElement('div');
        el.className='confetti';
        el.textContent = ['âœ¨','ðŸŽ‰','ðŸŽˆ','ðŸŽŠ','ðŸŽ†','ðŸŽ‡'][Math.floor(Math.random()*6)];
        el.style.left = x+'px';
        el.style.top = y+'px';
        const xMove = (Math.random()-0.5)*300;
        const yMove = (Math.random()-0.5)*300;
        el.animate([
          { transform:`translate(0,0) scale(1)`, opacity:1 },
          { transform:`translate(${xMove}px,${yMove}px) scale(1.5) rotate(360deg)`, opacity:0 }
        ],{ duration:1000+Math.random()*500, easing:'ease-out', fill:'forwards'});
        document.body.appendChild(el);
        setTimeout(()=>el.remove(),1500);
      }
    };

    document.addEventListener('click', surpriseClickListener);
  }

  function stopTheme() {
    if(window.__themeIntervals){
      window.__themeIntervals.forEach(i=>clearInterval(i));
      window.__themeIntervals=[];
    }
    document.body.classList.remove('theme-active');

    // remove click burst
    if(surpriseClickListener){
      document.removeEventListener('click', surpriseClickListener);
      surpriseClickListener = null;
    }
  }
</script>
